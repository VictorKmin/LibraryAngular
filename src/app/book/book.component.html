<div class="container">
  <div class="basicInfo">


    <!--THIS BLOCK OF CODE JUST FOR ADMIN USER-->
    <div *ngIf="userRole == 1">
      <button (click)="showDelete()">DELETE BOOK</button>
      <button *ngIf="book.is_reading" (click)="showNotReading()">Book not reading already</button>
      <button (click)="showUpdate()">Change info</button>

      <!--Buttons for delete book-->
      <div *ngIf="isDeleteClicked">
        DELETE THIS BOOK ? <br>
        <button (click)="deleteBook()"> YES. Destroy it!</button>
        <button (click)="showDelete()"> No. It's just miss click </button>
      </div>

      <div *ngIf="isReadingClicked">
        This book already in office ? <br>
        <button (click)="bookReturned()"> YES. Already here!</button>
        <button (click)="showNotReading()"> No. Some man still read this </button>
      </div>

      <!--Form for updating book-->
      <form #newInfo="ngForm" *ngIf="isUpdateClicked">
        Title:
        <input type="text" name="title"  ngModel placeholder="{{book.title}}">
        Author:
        <input type="text" name="author"  ngModel placeholder="{{book.author}}">
        Publisher:
        <input type="text" name="publisher"  ngModel placeholder="{{book.publisher}}">
        Summary:
        <input type="text" name="summary"  ngModel placeholder="{{book.summary}}">
        Tags:
        <input type="text" name="tags"  ngModel placeholder="{{book.tags}}">
        Subject:
        <input type="text" name="subject"  ngModel placeholder="{{book.subject}}">
        Type
        <select style="display:block;" ngModel name="typeOfBook"
                (change)="changeBookType($event.target)">
          <option value="handbook"> handbook </option>
          <option value="digital"> digital</option>
        </select>
        Photo
        <input type="file"  name="photo" ngModel
               (change)="photoInput($event)">
        <br>
        File
        <input *ngIf="isBookDigital" type="file" required name="file" ngModel
               (change)="fileInput($event)">
        <br>
        <button type="submit"
                [disabled]="!newInfo.valid"
                (click)="updateBook(newInfo.value)">
          Submit
        </button>
      </form>
    </div>
<!--FINISH OF ADMIN CODE-->

    <h1> {{book.title}} </h1>
    <b>Author: </b>{{book.author}}
    <br>
    <b>Publisher: </b>{{book.publisher}}
    <br>
    <b>Subject: </b>{{book.subject}}
    <div class="summary">
      {{book.summary}}
    </div>
    <br>
    <div *ngIf="tags">
      <b>Tags: </b>
      <span *ngFor="let tag of tags">
        <a style="cursor: pointer" routerLink='/search/tag/{{tag}}'>{{tag}}, </a>
      </span>
    </div>
    <br>
  </div>
  <div class="statistic">
    <img src="{{image}}" alt="{{book.title}}" class="image">

    <div *ngIf='isTokenPreset'>
      <!--FOR DIGITAL BOOKS-->
      <div *ngIf="is_digital">
        <p *ngFor="let link of links">
          <a href="{{API_HOST + link.location}}">Download {{link.type_of_file}}</a>
        </p>
      </div>
      <!--FOR HAND BOOKS-->
      <div *ngIf="!is_digital" class="bookIsReading">
        <span *ngIf="book.is_reading">This book reading until {{timeToEnd}}</span>
        <br>
        <span *ngIf="book.is_reading">{{book.userName}} read this book</span>
        <button *ngIf="!book.is_reading" (click)="readThisBook()" class="readBook">
          <span>I want read this book</span>
        </button>
        <div *ngIf="book.userIdWhoRead == userId && book.is_reading">
          <button class="btn still-read" (click)="sillRead(book.id, book.userIdWhoRead)">I still reading this</button>
          <button class="btn return-book" (click)="returnBook(book.id)">Return book</button>
        </div>
      </div>
    </div>
    <br>
    <a class="btn waves-effect waves-green commentButton"
       (click)="allBookComments()">
      See {{book.countOfComments}} comments
    </a>
  </div>

  <form #comment="ngForm" *ngIf="isTokenPreset">
    <input type="text" name="comment" required ngModel #comment="ngModel" placeholder="You can leave comment here">
    <button class="btn waves-effect waves-light" type="submit" name="action"
            [disabled]="!comment.valid"
            (click)="createComment(comment.value)">
      Submit
    </button>
  </form>
  <div class="allComments">
    <app-comment
      *ngFor=" let comment of comments"
      [comment]="comment">
    </app-comment>
  </div>
</div>
